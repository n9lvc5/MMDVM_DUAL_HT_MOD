/*
 *   Copyright (C) 2015 by Jonathan Naylor G4KLX
 *
 *   This program is free software; you can redistribute it and/or modify
 *   it under the terms of the GNU General Public License as published by
 *   the Free Software Foundation; either version 2 of the License, or
 *   (at your option) any later version.
 *
 *   This program is distributed in the hope that it will be useful,
 *   but WITHOUT ANY WARRANTY; without even the implied warranty of
 *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
 *   GNU General Public License for more details.
 *
 *   You should have received a copy of the GNU General Public License
 *   along with this program; if not, write to the Free Software
 *   Foundation, Inc., 675 Mass Ave, Cambridge, MA 02139, USA.
 */

#include "Globals.h"
#include "DMRSlotType.h"
#include "Debug.h"

// Note: DECODING_TABLE_1987 is kept if needed for other codes, but not used for slot type.

// Generated decoding table for Golay (20,8) using standard DMR polynomial

    const uint32_t DECODING_TABLE_2087[] = {
    0x00000U, 0x00001U, 0x00002U, 0x00003U, 0x00004U, 0x00005U, 0x00006U, 0x00007U,
    0x00008U, 0x00009U, 0x0000AU, 0x0000BU, 0x0000CU, 0x0000DU, 0x0000EU, 0x24020U,
    0x00010U, 0x00011U, 0x00012U, 0x00013U, 0x00014U, 0x00015U, 0x00016U, 0x00000U,
    0x00018U, 0x00019U, 0x0001AU, 0x00000U, 0x0001CU, 0x00000U, 0x48040U, 0x01480U,
    0x00020U, 0x00021U, 0x00022U, 0x00023U, 0x00024U, 0x00025U, 0x00026U, 0x24008U,
    0x00028U, 0x00029U, 0x0002AU, 0x24004U, 0x0002CU, 0x24002U, 0x24001U, 0x24000U,
    0x00030U, 0x00031U, 0x00032U, 0x08180U, 0x00034U, 0x00C40U, 0x00000U, 0xC0200U,
    0x00038U, 0x43000U, 0x00000U, 0x00000U, 0x90080U, 0x00000U, 0x02900U, 0x24010U,
    0x00040U, 0x00041U, 0x00042U, 0x00043U, 0x00044U, 0x00045U, 0x00046U, 0x00000U,
    0x00048U, 0x00049U, 0x0004AU, 0x02500U, 0x0004CU, 0x00000U, 0x48010U, 0x00000U,
    0x00050U, 0x00051U, 0x00052U, 0x21200U, 0x00054U, 0x00C20U, 0x48008U, 0x00000U,
    0x00058U, 0x00000U, 0x48004U, 0x00000U, 0x48002U, 0xA2000U, 0x48000U, 0x48001U,
    0x00060U, 0x00061U, 0x00062U, 0x00000U, 0x00064U, 0x00C10U, 0x10300U, 0x0B000U,
    0x00068U, 0x88200U, 0x01880U, 0x00000U, 0x00000U, 0x40180U, 0x00000U, 0x24040U,
    0x00070U, 0x00C04U, 0x86000U, 0x00000U, 0x00C01U, 0x00C00U, 0x00000U, 0x00C02U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x05200U, 0x00C08U, 0x48020U, 0x00000U,
    0x00080U, 0x00081U, 0x00082U, 0x00083U, 0x00084U, 0x00085U, 0x00086U, 0x00000U,
    0x00088U, 0x00089U, 0x0008AU, 0x50200U, 0x0008CU, 0x0A800U, 0x00000U, 0x01410U,
    0x00090U, 0x00091U, 0x00092U, 0x08120U, 0x00094U, 0x00000U, 0x04A00U, 0x01408U,
    0x00098U, 0x00000U, 0x00000U, 0x01404U, 0x90020U, 0x01402U, 0x01401U, 0x01400U,
    0x000A0U, 0x000A1U, 0x000A2U, 0x08110U, 0x000A4U, 0x00000U, 0x42400U, 0x00000U,
    0x000A8U, 0x00000U, 0x01840U, 0x00000U, 0x90010U, 0x40140U, 0x00000U, 0x24080U,
    0x000B0U, 0x08102U, 0x08101U, 0x08100U, 0x90008U, 0x00000U, 0x00000U, 0x08104U,
    0x90004U, 0x20A00U, 0x00000U, 0x08108U, 0x90000U, 0x90001U, 0x90002U, 0x01420U,
    0x000C0U, 0x000C1U, 0x000C2U, 0x00000U, 0x000C4U, 0x00000U, 0x00000U, 0x00000U,
    0x000C8U, 0x00000U, 0x01820U, 0x00000U, 0x20600U, 0x40120U, 0x16000U, 0x00000U,
    0x000D0U, 0x00000U, 0x00000U, 0x42800U, 0x03100U, 0x18200U, 0x00000U, 0x00000U,
    0x00000U, 0x00000U, 0x80300U, 0x00000U, 0x00000U, 0x00000U, 0x48080U, 0x01440U,
    0x000E0U, 0x32000U, 0x01808U, 0x04600U, 0x00000U, 0x40108U, 0x00000U, 0x00000U,
    0x01802U, 0x40104U, 0x01800U, 0x01801U, 0x40101U, 0x40100U, 0x01804U, 0x40102U,
    0x00000U, 0x00000U, 0x00000U, 0x08140U, 0x00000U, 0x00C80U, 0x00000U, 0x00000U,
    0x0A400U, 0x00000U, 0x01810U, 0x00000U, 0x90040U, 0x40110U, 0x00000U, 0x00000U,
    0x00100U, 0x00101U, 0x00102U, 0x00103U, 0x00104U, 0x00105U, 0x00106U, 0x41800U,
    0x00108U, 0x00109U, 0x0010AU, 0x02440U, 0x0010CU, 0x00000U, 0x00000U, 0x98000U,
    0x00110U, 0x00111U, 0x00112U, 0x080A0U, 0x00114U, 0x00000U, 0xA0400U, 0x00000U,
    0x00118U, 0x00000U, 0x15000U, 0x00000U, 0x00000U, 0x00000U, 0x02820U, 0x00000U,
    0x00120U, 0x00121U, 0x00122U, 0x08090U, 0x00124U, 0x00000U, 0x10240U, 0x00000U,
    0x00128U, 0x00000U, 0x00000U, 0x00000U, 0x09400U, 0x400C0U, 0x02810U, 0x24100U,
    0x00130U, 0x08082U, 0x08081U, 0x08080U, 0x00000U, 0x31000U, 0x02808U, 0x08084U,
    0x00000U, 0x84400U, 0x02804U, 0x08088U, 0x02802U, 0x00000U, 0x02800U, 0x02801U,
    0x00140U, 0x00141U, 0x00142U, 0x02408U, 0x00144U, 0x00000U, 0x10220U, 0x00000U,
    0x00148U, 0x02402U, 0x02401U, 0x02400U, 0x84800U, 0x400A0U, 0x00000U, 0x02404U,
    0x00150U, 0xD0000U, 0x00000U, 0x00000U, 0x03080U, 0x00000U, 0x00000U, 0x00000U,
    0x00000U, 0x09800U, 0x80280U, 0x02410U, 0x00000U, 0x00000U, 0x48100U, 0x00000U,
    0x00160U, 0x00000U, 0x10204U, 0xA0800U, 0x10202U, 0x40088U, 0x10200U, 0x10201U,
    0x00000U, 0x40084U, 0x00000U, 0x02420U, 0x40081U, 0x40080U, 0x10208U, 0x40082U,
    0x00000U, 0x00000U, 0x41400U, 0x080C0U, 0x00000U, 0x00D00U, 0x10210U, 0x00000U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x40090U, 0x02840U, 0x00000U,
    0x00180U, 0x00181U, 0x00182U, 0x08030U, 0x00184U, 0x14400U, 0x00000U, 0x22200U,
    0x00188U, 0xA1000U, 0x00000U, 0x00000U, 0x00000U, 0x40060U, 0x00000U, 0x00000U,
    0x00190U, 0x08022U, 0x08021U, 0x08020U, 0x03040U, 0x00000U, 0x00000U, 0x08024U,
    0x40C00U, 0x00000U, 0x80240U, 0x08028U, 0x2C000U, 0x00000U, 0x00000U, 0x01500U,
    0x001A0U, 0x08012U, 0x08011U, 0x08010U, 0x00000U, 0x40048U, 0x85000U, 0x08014U,
    0x06200U, 0x40044U, 0x30400U, 0x08018U, 0x40041U, 0x40040U, 0x00000U, 0x40042U,
    0x08003U, 0x08002U, 0x08001U, 0x08000U, 0x00000U, 0x08006U, 0x08005U, 0x08004U,
    0x00000U, 0x0800AU, 0x08009U, 0x08008U, 0x90100U, 0x40050U, 0x02880U, 0x0800CU,
    0x001C0U, 0x00000U, 0x64000U, 0x00000U, 0x03010U, 0x40028U, 0x08C00U, 0x00000U,
    0x00000U, 0x40024U, 0x80210U, 0x02480U, 0x40021U, 0x40020U, 0x00000U, 0x40022U,
    0x03004U, 0x00000U, 0x80208U, 0x08060U, 0x03000U, 0x03001U, 0x03002U, 0x00000U,
    0x80202U, 0x00000U, 0x80200U, 0x80201U, 0x03008U, 0x40030U, 0x80204U, 0x30800U,
    0x00000U, 0x4000CU, 0x00000U, 0x08050U, 0x40009U, 0x40008U, 0x10280U, 0x4000AU,
    0x40005U, 0x40004U, 0x01900U, 0x40006U, 0x40001U, 0x40000U, 0x40003U, 0x40002U,
    0x14800U, 0x08042U, 0x08041U, 0x08040U, 0x03020U, 0x40018U, 0x00000U, 0x08044U,
    0x00000U, 0x40014U, 0x80220U, 0x08048U, 0x40011U, 0x40010U, 0x00000U, 0x40012U,
    0x00200U, 0x00201U, 0x00202U, 0x00203U, 0x00204U, 0x00205U, 0x00206U, 0x00000U,
    0x00208U, 0x00209U, 0x0020AU, 0x50080U, 0x0020CU, 0x00000U, 0x83000U, 0x00000U,
    0x00210U, 0x00211U, 0x00212U, 0x21040U, 0x00214U, 0x00000U, 0x04880U, 0xC0020U,
    0x00218U, 0x00000U, 0x00000U, 0x0E000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U,
    0x00220U, 0x00221U, 0x00222U, 0x00000U, 0x00224U, 0x00000U, 0x10140U, 0xC0010U,
    0x00228U, 0x88040U, 0x00000U, 0x00000U, 0x00000U, 0x12400U, 0x00000U, 0x24200U,
    0x00230U, 0x00000U, 0x00000U, 0xC0004U, 0x2A000U, 0xC0002U, 0xC0001U, 0xC0000U,
    0x00000U, 0x20880U, 0x00000U, 0x00000U, 0x05040U, 0x00000U, 0x00000U, 0xC0008U,
    0x00240U, 0x00241U, 0x00242U, 0x21010U, 0x00244U, 0x46000U, 0x10120U, 0x00000U,
    0x00248U, 0x88020U, 0x00000U, 0x00000U, 0x20480U, 0x00000U, 0x00000U, 0x00000U,
    0x00250U, 0x21002U, 0x21001U, 0x21000U, 0x00000U, 0x18080U, 0x00000U, 0x21004U,
    0x12800U, 0x00000U, 0x80180U, 0x21008U, 0x05020U, 0x00000U, 0x48200U, 0x00000U,
    0x00260U, 0x88008U, 0x10104U, 0x04480U, 0x10102U, 0x00000U, 0x10100U, 0x10101U,
    0x88001U, 0x88000U, 0x62000U, 0x88002U, 0x05010U, 0x88004U, 0x10108U, 0x00000U,
    0x00000U, 0x00000U, 0x00000U, 0x21020U, 0x05008U, 0x00E00U, 0x10110U, 0xC0040U,
    0x05004U, 0x88010U, 0x00000U, 0x00000U, 0x05000U, 0x05001U, 0x05002U, 0x00000U,
    0x00280U, 0x00281U, 0x00282U, 0x50008U, 0x00284U, 0x00000U, 0x04810U, 0x22100U,
    0x00288U, 0x50002U, 0x50001U, 0x50000U, 0x20440U, 0x00000U, 0x00000U, 0x50004U,
    0x00290U, 0x82400U, 0x04804U, 0x00000U, 0x04802U, 0x18040U, 0x04800U, 0x04801U,
    0x00000U, 0x20820U, 0x80140U, 0x50010U, 0x00000U, 0x00000U, 0x04808U, 0x01600U,
    0x002A0U, 0x00000U, 0x00000U, 0x04440U, 0x00000U, 0x00000U, 0x00000U, 0x00000U,
    0x06100U, 0x20810U, 0x00000U, 0x50020U, 0x00000U, 0x00000U, 0x00000U, 0x00000U,
    0x00000U, 0x20808U, 0x13000U, 0x08300U, 0x00000U, 0x00000U, 0x04820U, 0xC0080U,
    0x20801U, 0x20800U, 0x00000U, 0x20802U, 0x90200U, 0x20804U, 0x00000U, 0x00000U,
    0x002C0U, 0x00000U, 0x00000U, 0x04420U, 0x20408U, 0x18010U, 0x00000U, 0x00000U,
    0x20404U, 0x00000U, 0x80110U, 0x50040U, 0x20400U, 0x20401U, 0x20402U, 0x00000U,
    0x00000U, 0x18004U, 0x80108U, 0x21080U, 0x18001U, 0x18000U, 0x04840U, 0x18002U,
    0x80102U, 0x00000U, 0x80100U, 0x80101U, 0x20410U, 0x18008U, 0x80104U, 0x00000U,
    0x00000U, 0x04402U, 0x04401U, 0x04400U, 0x82800U, 0x00000U, 0x10180U, 0x04404U,
    0x00000U, 0x88080U, 0x01A00U, 0x04408U, 0x20420U, 0x40300U, 0x00000U, 0x00000U,
    0x00000U, 0x00000U, 0x00000U, 0x04410U, 0x00000U, 0x18020U, 0x00000U, 0x00000U,
    0x00000U, 0x20840U, 0x80120U, 0x00000U, 0x05080U, 0x00000U, 0x00000U, 0x00000U,
    0x00300U, 0x00301U, 0x00302U, 0x00000U, 0x00304U, 0x00000U, 0x10060U, 0x22080U,
    0x00308U, 0x00000U, 0x28800U, 0x00000U, 0x00000U, 0x00000U, 0x44400U, 0x00000U,
    0x00310U, 0x00000U, 0x00000U, 0x10C00U, 0x00000U, 0x00000U, 0x00000U, 0x00000U,
    0x00000U, 0x00000U, 0x800C0U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U,
    0x00320U, 0x60400U, 0x10044U, 0x00000U, 0x10042U, 0x0C800U, 0x10040U, 0x10041U,
    0x06080U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x10048U, 0x00000U,
    0x81800U, 0x00000U, 0x00000U, 0x08280U, 0x00000U, 0x00000U, 0x10050U, 0xC0100U,
    0x58000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x02A00U, 0x00000U,
    0x00340U, 0x00000U, 0x10024U, 0x00000U, 0x10022U, 0x81400U, 0x10020U, 0x10021U,
    0x00000U, 0x34000U, 0x80090U, 0x02600U, 0x00000U, 0x00000U, 0x10028U, 0x00000U,
    0x0C400U, 0x00000U, 0x80088U, 0x21100U, 0x60800U, 0x00000U, 0x10030U, 0x00000U,
    0x80082U, 0x00000U, 0x80080U, 0x80081U, 0x00000U, 0x00000U, 0x80084U, 0x00000U,
    0x10006U, 0x00000U, 0x10004U, 0x10005U, 0x10002U, 0x10003U, 0x10000U, 0x10001U,
    0x00000U, 0x88100U, 0x1000CU, 0x00000U, 0x1000AU, 0x40280U, 0x10008U, 0x10009U,
    0x00000U, 0x00000U, 0x10014U, 0x00000U, 0x10012U, 0x00000U, 0x10010U, 0x10011U,
    0x00000U, 0x00000U, 0x800A0U, 0x44800U, 0x05100U, 0x00000U, 0x10018U, 0x28400U,
    0x00380U, 0x00000U, 0x00000U, 0x22004U, 0xC8000U, 0x22002U, 0x22001U, 0x22000U,
    0x06020U, 0x00000U, 0x80050U, 0x50100U, 0x11800U, 0x00000U, 0x00000U, 0x22008U,
    0x00000U, 0x45000U, 0x80048U, 0x08220U, 0x00000U, 0x00000U, 0x04900U, 0x22010U,
    0x80042U, 0x00000U, 0x80040U, 0x80041U, 0x00000U, 0x00000U, 0x80044U, 0x00000U,
    0x06008U, 0x00000U, 0x00000U, 0x08210U, 0x00000U, 0x00000U, 0x100C0U, 0x22020U,
    0x06000U, 0x06001U, 0x06002U, 0x00000U, 0x06004U, 0x40240U, 0x00000U, 0x80C00U,
    0x00000U, 0x08202U, 0x08201U, 0x08200U, 0x00000U, 0x00000U, 0x00000U, 0x08204U,
    0x06010U, 0x20900U, 0x80060U, 0x08208U, 0x00000U, 0x00000U, 0x61000U, 0x00000U,
    0x00000U, 0x00000U, 0x80018U, 0x00000U, 0x00000U, 0x00000U, 0x100A0U, 0x22040U,
    0x80012U, 0x00000U, 0x80010U, 0x80011U, 0x20500U, 0x40220U, 0x80014U, 0x0D000U,
    0x8000AU, 0x00000U, 0x80008U, 0x80009U, 0x03200U, 0x18100U, 0x8000CU, 0x00000U,
    0x80002U, 0x80003U, 0x80000U, 0x80001U, 0x80006U, 0x00000U, 0x80004U, 0x80005U,
    0x29000U, 0x00000U, 0x10084U, 0x04500U, 0x10082U, 0x40208U, 0x10080U, 0x10081U,
    0x06040U, 0x40204U, 0x80030U, 0x00000U, 0x40201U, 0x40200U, 0x10088U, 0x40202U,
    0x00000U, 0x00000U, 0x80028U, 0x08240U, 0x00000U, 0xA4000U, 0x10090U, 0x00000U,
    0x80022U, 0x11400U, 0x80020U, 0x80021U, 0x00000U, 0x40210U, 0x80024U, 0x00000U,
    0x00400U, 0x00401U, 0x00402U, 0x00403U, 0x00404U, 0x00405U, 0x00406U, 0x00000U,
    0x00408U, 0x00409U, 0x0040AU, 0x02140U, 0x0040CU, 0x00000U, 0x00000U, 0x01090U,
    0x00410U, 0x00411U, 0x00412U, 0x00000U, 0x00414U, 0x00860U, 0xA0100U, 0x01088U,
    0x00418U, 0x38000U, 0x00000U, 0x01084U, 0x00000U, 0x01082U, 0x01081U, 0x01080U,
    0x00420U, 0x00421U, 0x00422U, 0x91000U, 0x00424U, 0x00850U, 0x42080U, 0x00000U,
    0x00428U, 0x00000U, 0x00000U, 0x48800U, 0x09100U, 0x12200U, 0x00000U, 0x24400U,
    0x00430U, 0x00844U, 0x00000U, 0x00000U, 0x00841U, 0x00840U, 0x1C000U, 0x00842U,
    0x00000U, 0x84100U, 0x00000U, 0x00000U, 0x00000U, 0x00848U, 0x00000U, 0x010A0U,
    0x00440U, 0x00441U, 0x00442U, 0x02108U, 0x00444U, 0x00830U, 0x00000U, 0x70000U,
    0x00448U, 0x02102U, 0x02101U, 0x02100U, 0x20280U, 0x00000U, 0x00000U, 0x02104U,
    0x00450U, 0x00824U, 0x00000U, 0x00000U, 0x00821U, 0x00820U, 0x00000U, 0x00822U,
    0x00000U, 0x00000U, 0x24800U, 0x02110U, 0x00000U, 0x00828U, 0x48400U, 0x010C0U,
    0x00460U, 0x00814U, 0x00000U, 0x04280U, 0x00811U, 0x00810U, 0x00000U, 0x00812U,
    0x54000U, 0x00000U, 0x00000U, 0x02120U, 0x00000U, 0x00818U, 0x00000U, 0x00000U,
    0x00805U, 0x00804U, 0x41100U, 0x00806U, 0x00801U, 0x00800U, 0x00803U, 0x00802U,
    0x0A080U, 0x0080CU, 0x00000U, 0x00000U, 0x00809U, 0x00808U, 0x00000U, 0x0080AU,
    0x00480U, 0x00481U, 0x00482U, 0x00000U, 0x00484U, 0x14100U, 0x42020U, 0x01018U,
    0x00488U, 0x00000U, 0x8C000U, 0x01014U, 0x20240U, 0x01012U, 0x01011U, 0x01010U,
    0x00490U, 0x82200U, 0x00000U, 0x0100CU, 0x00000U, 0x0100AU, 0x01009U, 0x01008U,
    0x40900U, 0x01006U, 0x01005U, 0x01004U, 0x01003U, 0x01002U, 0x01001U, 0x01000U,
    0x004A0U, 0x00000U, 0x42004U, 0x04240U, 0x42002U, 0xA8000U, 0x42000U, 0x42001U,
    0x00000U, 0x00000U, 0x30100U, 0x00000U, 0x00000U, 0x00000U, 0x42008U, 0x01030U,
    0x25000U, 0x00000U, 0x00000U, 0x08500U, 0x00000U, 0x008C0U, 0x42010U, 0x01028U,
    0x0A040U, 0x00000U, 0x00000U, 0x01024U, 0x90400U, 0x01022U, 0x01021U, 0x01020U,
    0x004C0U, 0x49000U, 0x00000U, 0x04220U, 0x20208U, 0x00000U, 0x08900U, 0x00000U,
    0x20204U, 0x90800U, 0x00000U, 0x02180U, 0x20200U, 0x20201U, 0x20202U, 0x01050U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0xC4000U, 0x008A0U, 0x00000U, 0x01048U,
    0x0A020U, 0x00000U, 0x00000U, 0x01044U, 0x20210U, 0x01042U, 0x01041U, 0x01040U,
    0x00000U, 0x04202U, 0x04201U, 0x04200U, 0x00000U, 0x00890U, 0x42040U, 0x04204U,
    0x0A010U, 0x00000U, 0x01C00U, 0x04208U, 0x20220U, 0x40500U, 0x00000U, 0x00000U,
    0x0A008U, 0x00884U, 0x00000U, 0x04210U, 0x00881U, 0x00880U, 0x00000U, 0x00882U,
    0x0A000U, 0x0A001U, 0x0A002U, 0xE0000U, 0x0A004U, 0x00888U, 0x00000U, 0x01060U,
    0x00500U, 0x00501U, 0x00502U, 0x02048U, 0x00504U, 0x14080U, 0xA0010U, 0x00000U,
    0x00508U, 0x02042U, 0x02041U, 0x02040U, 0x09020U, 0x00000U, 0x44200U, 0x02044U,
    0x00510U, 0x00000U, 0xA0004U, 0x10A00U, 0xA0002U, 0x4A000U, 0xA0000U, 0xA0001U,
    0x40880U, 0x84020U, 0x00000U, 0x02050U, 0x00000U, 0x00000U, 0xA0008U, 0x01180U,
    0x00520U, 0x60200U, 0x00000U, 0x00000U, 0x09008U, 0x00000U, 0x00000U, 0x00000U,
    0x09004U, 0x84010U, 0x30080U, 0x02060U, 0x09000U, 0x09001U, 0x09002U, 0x00000U,
    0x00000U, 0x84008U, 0x41040U, 0x08480U, 0x00000U, 0x00940U, 0xA0020U, 0x00000U,
    0x84001U, 0x84000U, 0x00000U, 0x84002U, 0x09010U, 0x84004U, 0x02C00U, 0x00000U,
    0x00540U, 0x0200AU, 0x02009U, 0x02008U, 0x00000U, 0x81200U, 0x08880U, 0x0200CU,
    0x02003U, 0x02002U, 0x02001U, 0x02000U, 0x00000U, 0x02006U, 0x02005U, 0x02004U,
    0x0C200U, 0x00000U, 0x41020U, 0x02018U, 0x00000U, 0x00920U, 0xA0040U, 0x00000U,
    0x00000U, 0x02012U, 0x02011U, 0x02010U, 0x00000U, 0x00000U, 0x00000U, 0x02014U,
    0x00000U, 0x00000U, 0x41010U, 0x02028U, 0x26000U, 0x00910U, 0x10600U, 0x00000U,
    0x00000U, 0x02022U, 0x02021U, 0x02020U, 0x09040U, 0x40480U, 0x00000U, 0x02024U,
    0x41002U, 0x00904U, 0x41000U, 0x41001U, 0x00901U, 0x00900U, 0x41004U, 0x00902U,
    0x00000U, 0x84040U, 0x41008U, 0x02030U, 0x00000U, 0x00908U, 0x00000U, 0x28200U,
    0x00580U, 0x14004U, 0x00000U, 0x00000U, 0x14001U, 0x14000U, 0x08840U, 0x14002U,
    0x40810U, 0x00000U, 0x30020U, 0x020C0U, 0x00000U, 0x14008U, 0x00000U, 0x01110U,
    0x40808U, 0x00000U, 0x00000U, 0x08420U, 0x00000U, 0x14010U, 0xA0080U, 0x01108U,
    0x40800U, 0x40801U, 0x40802U, 0x01104U, 0x40804U, 0x01102U, 0x01101U, 0x01100U,
    0x00000U, 0x03800U, 0x30008U, 0x08410U, 0x00000U, 0x14020U, 0x42100U, 0x00000U,
    0x30002U, 0x00000U, 0x30000U, 0x30001U, 0x09080U, 0x40440U, 0x30004U, 0x80A00U,
    0x00000U, 0x08402U, 0x08401U, 0x08400U, 0x00000U, 0x00000U, 0x00000U, 0x08404U,
    0x40820U, 0x84080U, 0x30010U, 0x08408U, 0x00000U, 0x00000U, 0x00000U, 0x01120U,
    0x00000U, 0x00000U, 0x08804U, 0x02088U, 0x08802U, 0x14040U, 0x08800U, 0x08801U,
    0x00000U, 0x02082U, 0x02081U, 0x02080U, 0x20300U, 0x40420U, 0x08808U, 0x02084U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x03400U, 0x00000U, 0x08810U, 0x00000U,
    0x40840U, 0x00000U, 0x80600U, 0x02090U, 0x00000U, 0x00000U, 0x00000U, 0x01140U,
    0x00000U, 0x00000U, 0x00000U, 0x04300U, 0x00000U, 0x40408U, 0x08820U, 0x00000U,
    0x00000U, 0x40404U, 0x30040U, 0x020A0U, 0x40401U, 0x40400U, 0x00000U, 0x40402U,
    0x00000U, 0x00000U, 0x41080U, 0x08440U, 0x00000U, 0x00980U, 0x00000U, 0x92000U,
    0x0A100U, 0x11200U, 0x00000U, 0x00000U, 0x00000U, 0x40410U, 0x00000U, 0x00000U,
    0x00600U, 0x00601U, 0x00602U, 0x00000U, 0x00604U, 0x00000U, 0x00000U, 0x00000U,
    0x00608U, 0x05800U, 0x00000U, 0x00000U, 0x200C0U, 0x12020U, 0x44100U, 0x00000U,
    0x00610U, 0x82080U, 0x00000U, 0x10900U, 0x51000U, 0x00000U, 0x00000U, 0x00000U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x88800U, 0x00000U, 0x00000U, 0x01280U,
    0x00620U, 0x60100U, 0x00000U, 0x040C0U, 0x00000U, 0x12008U, 0x21800U, 0x00000U,
    0x00000U, 0x12004U, 0x00000U, 0x00000U, 0x12001U, 0x12000U, 0x00000U, 0x12002U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00A40U, 0x00000U, 0xC0400U,
    0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x00000U, 0x12010U, 0x00000U, 0x00000U,
};

const uint16_t ENCODING_TABLE_2087[] =
    {0x0000U, 0xB08EU, 0xE093U, 0x501DU, 0x70A9U, 0xC027U, 0x903AU, 0x20B4U, 0x60DCU, 0xD052U, 0x804FU, 0x30C1U,
     0x1075U, 0xA0FBU, 0xF0E6U, 0x4068U, 0x7036U, 0xC0B8U, 0x90A5U, 0x202BU, 0x009FU, 0xB011U, 0xE00CU, 0x5082U,
     0x10EAU, 0xA064U, 0xF079U, 0x40F7U, 0x6043U, 0xD0CDU, 0x80D0U, 0x305EU, 0xD06CU, 0x60E2U, 0x30FFU, 0x8071U,
     0xA0C5U, 0x104BU, 0x4056U, 0xF0D8U, 0xB0B0U, 0x003EU, 0x5023U, 0xE0ADU, 0xC019U, 0x7097U, 0x208AU, 0x9004U,
     0xA05AU, 0x10D4U, 0x40C9U, 0xF047U, 0xD0F3U, 0x607DU, 0x3060U, 0x80EEU, 0xC086U, 0x7008U, 0x2015U, 0x909BU,
     0xB02FU, 0x00A1U, 0x50BCU, 0xE032U, 0x90D9U, 0x2057U, 0x704AU, 0xC0C4U, 0xE070U, 0x50FEU, 0x00E3U, 0xB06DU,
     0xF005U, 0x408BU, 0x1096U, 0xA018U, 0x80ACU, 0x3022U, 0x603FU, 0xD0B1U, 0xE0EFU, 0x5061U, 0x007CU, 0xB0F2U,
     0x9046U, 0x20C8U, 0x70D5U, 0xC05BU, 0x8033U, 0x30BDU, 0x60A0U, 0xD02EU, 0xF09AU, 0x4014U, 0x1009U, 0xA087U,
     0x40B5U, 0xF03BU, 0xA026U, 0x10A8U, 0x301CU, 0x8092U, 0xD08FU, 0x6001U, 0x2069U, 0x90E7U, 0xC0FAU, 0x7074U,
     0x50C0U, 0xE04EU, 0xB053U, 0x00DDU, 0x3083U, 0x800DU, 0xD010U, 0x609EU, 0x402AU, 0xF0A4U, 0xA0B9U, 0x1037U,
     0x505FU, 0xE0D1U, 0xB0CCU, 0x0042U, 0x20F6U, 0x9078U, 0xC065U, 0x70EBU, 0xA03DU, 0x10B3U, 0x40AEU, 0xF020U,
     0xD094U, 0x601AU, 0x3007U, 0x8089U, 0xC0E1U, 0x706FU, 0x2072U, 0x90FCU, 0xB048U, 0x00C6U, 0x50DBU, 0xE055U,
     0xD00BU, 0x6085U, 0x3098U, 0x8016U, 0xA0A2U, 0x102CU, 0x4031U, 0xF0BFU, 0xB0D7U, 0x0059U, 0x5044U, 0xE0CAU,
     0xC07EU, 0x70F0U, 0x20EDU, 0x9063U, 0x7051U, 0xC0DFU, 0x90C2U, 0x204CU, 0x00F8U, 0xB076U, 0xE06BU, 0x50E5U,
     0x108DU, 0xA003U, 0xF01EU, 0x4090U, 0x6024U, 0xD0AAU, 0x80B7U, 0x3039U, 0x0067U, 0xB0E9U, 0xE0F4U, 0x507AU,
     0x70CEU, 0xC040U, 0x905DU, 0x20D3U, 0x60BBU, 0xD035U, 0x8028U, 0x30A6U, 0x1012U, 0xA09CU, 0xF081U, 0x400FU,
     0x30E4U, 0x806AU, 0xD077U, 0x60F9U, 0x404DU, 0xF0C3U, 0xA0DEU, 0x1050U, 0x5038U, 0xE0B6U, 0xB0ABU, 0x0025U,
     0x2091U, 0x901FU, 0xC002U, 0x708CU, 0x40D2U, 0xF05CU, 0xA041U, 0x10CFU, 0x307BU, 0x80F5U, 0xD0E8U, 0x6066U,
     0x200EU, 0x9080U, 0xC09DU, 0x7013U, 0x50A7U, 0xE029U, 0xB034U, 0x00BAU, 0xE088U, 0x5006U, 0x001BU, 0xB095U,
     0x9021U, 0x20AFU, 0x70B2U, 0xC03CU, 0x8054U, 0x30DAU, 0x60C7U, 0xD049U, 0xF0FDU, 0x4073U, 0x106EU, 0xA0E0U,
     0x90BEU, 0x2030U, 0x702DU, 0xC0A3U, 0xE017U, 0x5099U, 0x0084U, 0xB00AU, 0xF062U, 0x40ECU, 0x10F1U, 0xA07FU,
     0x80CBU, 0x3045U, 0x6058U, 0xD0D6U};

#define X18             0x00040000   /* vector representation of X^{18} */
#define X11             0x00000800   /* vector representation of X^{11} */
#define MASK8           0xfffff800   /* auxiliary vector for testing */
#define GENPOL          0x00000c75   /* generator polynomial, g(x) - for other codes */
#define GENPOL_GOLAY 0x0C75U  // Correct for Golay (20,8): x^11 + x^10 + x^6 + x^5 + x^4 + x^2 + 1
//try adjusting the polynomial to 0xce5 if needed and regenerate

CDMRSlotType::CDMRSlotType()
{
}

uint32_t CDMRSlotType::getSyndrome1987(uint32_t pattern) const
{
  // This is for other codes, not slot type - kept if needed.
  unsigned int aux = X18;
 
  if (pattern >= X11) {
    while (pattern & MASK8) {
      while (!(aux & pattern))
        aux = aux >> 1;

      pattern ^= (aux / X11) * GENPOL;
    }
  }

  // [debug removed]
  
  return pattern;
}

uint32_t CDMRSlotType::getSyndrome2087(uint32_t pattern) const
{
  pattern &= 0xFFFFFU;  // Mask to 20 bits
  for (unsigned int i = 19; i > 10; i--) {
    if (pattern & (1U << i))
      pattern ^= GENPOL_GOLAY << (i - 11);
  }
  return pattern & 0x07FFU;  // Syndrome in low 11 bits
}

uint8_t CDMRSlotType::correct(uint8_t* data) const
{
  uint32_t code = (data[0U] << 12) + (data[1U] << 4) + (data[2U] >> 4);
  uint32_t syndrome = getSyndrome2087(code);
  uint32_t error_pattern = DECODING_TABLE_2087[syndrome];

  if (error_pattern != 0x00U) {
    code ^= error_pattern;
    // [debug removed]
  }
  
  return (uint8_t)(code >> 12);  // Return high 8 bits (info)
}

uint8_t CDMRSlotType::decode2087(const uint8_t* data) const
{
  uint32_t code = (data[0U] << 12) + (data[1U] << 4) + (data[2U] >> 4);
  uint32_t syndrome = getSyndrome2087(code);
  uint32_t error_pattern = DECODING_TABLE_2087[syndrome];

  if (error_pattern != 0x00U) {
    code ^= error_pattern;
    // [debug removed]
  }
  
  return (uint8_t)(code >> 12);
}

void CDMRSlotType::decode(const uint8_t* frame, uint8_t& colorCode, uint8_t& dataType) const
{
  uint8_t slotType[3U];
  slotType[0U]  = (frame[12U] << 2) & 0xFCU;
  slotType[0U] |= (frame[13U] >> 6) & 0x03U;

  slotType[1U]  = (frame[13U] << 2) & 0xC0U;
  slotType[1U] |= (frame[19U] << 2) & 0x3CU;
  slotType[1U] |= (frame[20U] >> 6) & 0x03U;

  slotType[2U]  = (frame[20U] << 2) & 0xF0U;

  uint8_t code = decode2087(slotType);

  colorCode = (code >> 4) & 0x0FU;
  dataType  = (code >> 0) & 0x0FU;

  // [debug removed]
}

void CDMRSlotType::encode(uint8_t colorCode, uint8_t dataType, uint8_t* frame) const
{
  uint8_t slotType[3U];
  slotType[0U]  = (colorCode << 4) & 0xF0U;
  slotType[0U] |= (dataType  << 0) & 0x0FU;

  uint16_t cksum = ENCODING_TABLE_2087[slotType[0U]];

  slotType[1U] = (cksum >> 0) & 0xFFU;
  slotType[2U] = (cksum >> 8) & 0xFFU;

  // [debug removed]
  frame[12U] = (frame[12U] & 0xC0U) | ((slotType[0U] >> 2) & 0x3FU);
  frame[13U] = (frame[13U] & 0x0FU) | ((slotType[0U] << 6) & 0xC0U) | ((slotType[1U] >> 2) & 0x30U);
  frame[19U] = (frame[19U] & 0xF0U) | ((slotType[1U] >> 2) & 0x0FU);
  frame[20U] = (frame[20U] & 0x03U) | ((slotType[1U] << 6) & 0xC0U) | ((slotType[2U] >> 2) & 0x3CU);
}